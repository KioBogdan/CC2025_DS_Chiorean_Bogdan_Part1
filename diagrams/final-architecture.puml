@startuml
title Final - Integrated Architecture (End-to-End + Visualizations)

skinparam componentStyle rectangle
skinparam shadowing false

actor "User/Admin" as UA

rectangle "Client" {
  [React Frontend\nDashboard:\n- Latest table\n- Trend line\n- Records per device] as FE
}

rectangle "Security (AWS)" {
  [AWS Cognito\nJWT + Groups\ncustom:device_id] as COG
}

rectangle "Backend API (Azure)" {
  [FastAPI\n/api/latest\n/api/trend\n/api/device-counts\nJWT verify + filtering] as API
}

database "Azure Blob Storage\nprocessed container" as BLOB

rectangle "Data Pipeline (Azure)" {
  [Azure Data Factory\nCSV ingestion -> JSON outputs] as ADF
}

rectangle "Event/Notification" {
  [Azure Function\nTrigger on processed write\nNotify Teams] as FUNC
  [Microsoft Teams Channel] as TEAMS
}

UA --> FE
FE --> COG : Sign-in / tokens
FE --> API : GET latest/trend/counts\nBearer JWT
API --> COG : Verify JWT
BLOB --> API : Read latest/*.json

ADF --> BLOB : Write latest + by-timestamp
BLOB --> FUNC : Blob trigger
FUNC --> TEAMS : Notification\n(success/fail)

@enduml
